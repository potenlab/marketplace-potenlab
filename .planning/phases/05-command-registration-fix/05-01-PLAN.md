---
phase: 05-command-registration-fix
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - commands/research.md
  - commands/slice.md
  - commands/commit.md
  - commands/context.md
  - commands/help.md
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Running /pl:research invokes the research skill"
    - "Running /pl:slice invokes the slice skill"
    - "Running /pl:commit invokes the commit skill"
    - "Running /pl:context invokes the context skill"
    - "Running /pl:help displays all 8 commands"
  artifacts:
    - path: "commands/research.md"
      provides: "Command file enabling /pl:research slash command"
      contains: "skills/research/SKILL.md"
    - path: "commands/slice.md"
      provides: "Command file enabling /pl:slice slash command"
      contains: "skills/slice/SKILL.md"
    - path: "commands/commit.md"
      provides: "Command file enabling /pl:commit slash command"
      contains: "skills/commit/SKILL.md"
    - path: "commands/context.md"
      provides: "Command file enabling /pl:context slash command"
      contains: "skills/context/SKILL.md"
    - path: "commands/help.md"
      provides: "Updated help showing all 8 commands"
      contains: "/pl:commit"
  key_links:
    - from: "commands/research.md"
      to: "skills/research/SKILL.md"
      via: "reference in file"
      pattern: "skills/research/SKILL.md"
    - from: "commands/slice.md"
      to: "skills/slice/SKILL.md"
      via: "reference in file"
      pattern: "skills/slice/SKILL.md"
    - from: "commands/commit.md"
      to: "skills/commit/SKILL.md"
      via: "reference in file"
      pattern: "skills/commit/SKILL.md"
    - from: "commands/context.md"
      to: "skills/context/SKILL.md"
      via: "reference in file"
      pattern: "skills/context/SKILL.md"
---

<objective>
Create the 4 missing command files (research, slice, commit, context) and update help to list all 8 commands.

Purpose: Phase 3 and 4 created skills but forgot command files. Without command files in commands/, the slash commands are not registered with Claude Code.

Output: 5 files in commands/ directory enabling all 8 /pl:* slash commands
</objective>

<execution_context>
@/Users/deprasny/.claude/get-shit-done/workflows/execute-plan.md
@/Users/deprasny/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

Pattern to follow:
@commands/refactor.md
@commands/review.md

Skills to reference:
@skills/research/SKILL.md
@skills/slice/SKILL.md
@skills/commit/SKILL.md
@skills/context/SKILL.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create 4 missing command files</name>
  <files>
    commands/research.md
    commands/slice.md
    commands/commit.md
    commands/context.md
  </files>
  <action>
Create command files following the pattern from commands/refactor.md and commands/review.md.

Each file needs:
1. YAML frontmatter with:
   - description: Brief description matching skill
   - allowed-tools (ONLY where appropriate):
     - commit.md: Bash (for git), Read, Grep
     - context.md: NO allowed-tools (uses built-in /cost and /context)
     - research.md: Task (for sub-agents), Read, Grep, Glob, WebFetch
     - slice.md: NO allowed-tools restriction (needs full access for code generation including mcp__figma tools)

2. Markdown body with:
   - H1: Command name
   - Description of what the command does
   - Usage examples showing typical invocations
   - Reference to the skill file: "See `skills/{name}/SKILL.md` for the full skill definition."

Specific content for each:

**commands/research.md:**
- Description: Research a topic using parallel sub-agents across multiple dimensions
- Usage examples: /pl:research "nextjs auth patterns", /pl:research "state management for React"
- Note: Uses Task tool for parallel sub-agent execution

**commands/slice.md:**
- Description: Convert Figma design to component code using MCP integration
- Usage examples: /pl:slice https://www.figma.com/design/.../node-id=123-456
- Note: Requires Figma MCP to be configured

**commands/commit.md:**
- Description: Create well-formatted git commits with conventional commits format
- Usage examples: /pl:commit, /pl:commit "feat: add auth"
- Note: Analyzes staged changes and generates appropriate commit message

**commands/context.md:**
- Description: Display current token usage and budget status with recommendations
- Usage examples: /pl:context
- Note: Runs /cost and /context to gather data
  </action>
  <verify>
ls -la commands/ shows 8 files: commit.md, context.md, help.md, init.md, refactor.md, research.md, review.md, slice.md

grep -l "SKILL.md" commands/*.md should return all 6 skill-backed commands (commit, context, refactor, research, review, slice)
  </verify>
  <done>
4 new command files exist with proper frontmatter and content matching the established pattern
  </done>
</task>

<task type="auto">
  <name>Task 2: Update help.md to list all 8 commands</name>
  <files>commands/help.md</files>
  <action>
Update commands/help.md to list all 8 commands alphabetically in the Available Commands table.

Replace the current 4-command table and "Coming Soon" section with:

| Command | Description |
|---------|-------------|
| `/pl:commit [hint]` | Create well-formatted git commits with conventional commits format |
| `/pl:context` | Display current token usage and budget status with recommendations |
| `/pl:help` | Display this help message showing all available commands |
| `/pl:init` | Initialize project with MCPs, rules, and agents in one command |
| `/pl:refactor <file>` | Refactor code with before/after explanation and test verification |
| `/pl:research <topic>` | Research a topic using parallel sub-agents across multiple dimensions |
| `/pl:review <file>` | Analyze code and return structured feedback (read-only) |
| `/pl:slice <figma-link>` | Convert Figma design to component code using MCP integration |

Remove the "Coming Soon" section entirely since all commands are now available.

Keep the rest of the file structure (Usage, About sections).
  </action>
  <verify>
grep -c "/pl:" commands/help.md returns 8 (one for each command in the table)

grep "Coming Soon" commands/help.md returns no matches
  </verify>
  <done>
help.md lists all 8 commands alphabetically with descriptions and argument hints
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify all commands are functional</name>
  <files>N/A - verification only</files>
  <action>
Verify the command registration is complete:

1. Confirm all 8 command files exist:
   ls commands/*.md | wc -l should return 8

2. Confirm frontmatter is valid for each new file:
   - Each file should start with ---
   - Each file should have a description field

3. Confirm skill references are correct:
   grep "skills/.*/SKILL.md" commands/*.md should show references for commit, context, refactor, research, review, slice

4. Confirm help.md has all 8 commands:
   grep "/pl:" commands/help.md should show 8 matches (all commands)

5. List final state of commands directory
  </action>
  <verify>
All verification commands pass without errors
  </verify>
  <done>
Commands directory contains 8 properly formatted command files, help lists all 8, all skill-backed commands reference their SKILL.md files
  </done>
</task>

</tasks>

<verification>
Phase verification checklist:
- [ ] commands/research.md exists and references skills/research/SKILL.md
- [ ] commands/slice.md exists and references skills/slice/SKILL.md
- [ ] commands/commit.md exists and references skills/commit/SKILL.md
- [ ] commands/context.md exists and references skills/context/SKILL.md
- [ ] commands/help.md lists all 8 commands
- [ ] No "Coming Soon" section in help.md
- [ ] All command files have valid YAML frontmatter
</verification>

<success_criteria>
1. Running `/pl:research` will invoke the research skill (command file exists)
2. Running `/pl:slice` will invoke the slice skill (command file exists)
3. Running `/pl:commit` will invoke the commit skill (command file exists)
4. Running `/pl:context` will invoke the context skill (command file exists)
5. Running `/pl:help` displays all 8 commands (help.md updated)
6. All new command files follow the established pattern from refactor.md/review.md
</success_criteria>

<output>
After completion, create `.planning/phases/05-command-registration-fix/05-01-SUMMARY.md`
</output>
