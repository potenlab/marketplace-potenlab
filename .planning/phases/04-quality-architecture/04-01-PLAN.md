---
phase: 04-quality-architecture
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - skills/context/SKILL.md
  - skills/commit/SKILL.md
  - skills/help/SKILL.md
autonomous: true

must_haves:
  truths:
    - "Running /pl:context displays token usage and budget status"
    - "Running /pl:commit creates well-formatted commits with context"
    - "Running /pl:help shows context and commit commands"
  artifacts:
    - path: "skills/context/SKILL.md"
      provides: "Context status skill with dynamic injection"
      contains: "name: context"
    - path: "skills/commit/SKILL.md"
      provides: "Smart commit skill with conventional commits"
      contains: "name: commit"
    - path: "skills/help/SKILL.md"
      provides: "Updated help with all 8 commands"
      contains: "/pl:context"
  key_links:
    - from: "skills/context/SKILL.md"
      to: "built-in /context command"
      via: "!command dynamic injection"
      pattern: "!`"
    - from: "skills/commit/SKILL.md"
      to: "git CLI"
      via: "!command for git state"
      pattern: "git diff"
---

<objective>
Create context and commit skills for Phase 4 quality requirements.

Purpose: Enable team to monitor token usage with /pl:context and create well-formatted commits with /pl:commit. These skills wrap Claude Code's built-in features with user-friendly presentation.

Output: Two new skills (context, commit) and updated help command showing all 8 /pl:* commands.
</objective>

<execution_context>
@/Users/deprasny/.claude/get-shit-done/workflows/execute-plan.md
@/Users/deprasny/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-quality-architecture/04-RESEARCH.md
@skills/help/SKILL.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create context skill with dynamic injection</name>
  <files>skills/context/SKILL.md</files>
  <action>
Create the context skill that displays token usage and budget status.

Use the `!command` syntax to inject dynamic git and session data. The skill should:

1. Use `disable-model-invocation: true` (read-only, no side effects on trigger)
2. Inject current git branch and status via `!` commands
3. Instruct Claude to run `/context` and `/cost` commands
4. Provide analysis template showing:
   - Token usage breakdown (conversation, CLAUDE.md, MCP tools, skills)
   - Budget status (healthy/filling/attention needed)
   - Recommendations based on status
   - Tips for context management (/clear, /compact, /mcp)

Follow the output format structure from the research:
```
### Context Status

**Summary:** [Brief assessment]

#### Token Usage
| Category | Tokens | Percentage |
...

#### Budget Status
- [ ] Context is healthy (< 50% used)
...

#### Recommendations
1. [Action based on status]

#### Notes
- Tips for /clear, /compact, /mcp
```

Reference Pattern 1 from 04-RESEARCH.md for implementation.
  </action>
  <verify>File exists at skills/context/SKILL.md with correct frontmatter (name: context, disable-model-invocation: true)</verify>
  <done>Context skill created with dynamic injection pattern and standardized output format</done>
</task>

<task type="auto">
  <name>Task 2: Create commit skill with conventional commits</name>
  <files>skills/commit/SKILL.md</files>
  <action>
Create the commit skill that creates well-formatted git commits.

Use the `!command` syntax to inject current git state. The skill should:

1. Use `disable-model-invocation: true` (has side effects - creates commits)
2. Include `argument-hint: [message-hint]` for optional commit type hints
3. Inject via `!` commands:
   - Current branch: `git branch --show-current`
   - Git status: `git status --short`
   - Recent history: `git log --oneline -3`
   - Changes to commit: `git diff HEAD`
4. Guide Claude to:
   - Analyze changes and determine type (feat, fix, docs, refactor, test, chore)
   - Stage appropriate files (exclude .env, credentials, node_modules)
   - Generate Conventional Commits message
   - Create the commit
5. Use $ARGUMENTS as optional hint for type/scope

Output format:
```
### Commit Created

**Hash:** `[short hash]`
**Type:** [feat|fix|docs|etc]

**Message:**
\`\`\`
[full commit message]
\`\`\`

#### Files Changed
| File | Changes |
|------|---------|
| [path] | +X / -Y lines |

#### Notes
- [Follow-up actions or warnings]
```

Reference Pattern 3 from 04-RESEARCH.md for implementation.
  </action>
  <verify>File exists at skills/commit/SKILL.md with correct frontmatter (name: commit, disable-model-invocation: true, argument-hint)</verify>
  <done>Commit skill created with git workflow and conventional commits format</done>
</task>

<task type="auto">
  <name>Task 3: Update help command with new skills</name>
  <files>skills/help/SKILL.md</files>
  <action>
Update the help skill to include /pl:context and /pl:commit commands.

Current commands (6):
- /pl:help
- /pl:init
- /pl:review <file>
- /pl:refactor <file>
- /pl:research <topic>
- /pl:slice <figma-link>

Add new commands (bringing total to 8):
- /pl:context - Display current token usage and budget status
- /pl:commit [message-hint] - Create well-formatted git commit with conventional commits format

Update the table to include all 8 commands, maintaining alphabetical order within the table. Keep the existing structure and GitHub link.
  </action>
  <verify>Help skill contains all 8 commands including /pl:context and /pl:commit</verify>
  <done>Help command updated with context and commit skills, showing all 8 /pl:* commands</done>
</task>

</tasks>

<verification>
1. `ls skills/context/SKILL.md skills/commit/SKILL.md` - Both files exist
2. `grep -l "name: context" skills/context/SKILL.md` - Context skill has correct name
3. `grep -l "name: commit" skills/commit/SKILL.md` - Commit skill has correct name
4. `grep -c "/pl:" skills/help/SKILL.md` - Returns 8 (all commands listed)
5. `grep "disable-model-invocation: true" skills/context/SKILL.md skills/commit/SKILL.md` - Both have the flag
</verification>

<success_criteria>
- /pl:context skill exists with dynamic injection pattern
- /pl:commit skill exists with conventional commits workflow
- /pl:help shows all 8 commands
- Both new skills use disable-model-invocation: true
- Both new skills follow standardized output format
</success_criteria>

<output>
After completion, create `.planning/phases/04-quality-architecture/04-01-SUMMARY.md`
</output>
